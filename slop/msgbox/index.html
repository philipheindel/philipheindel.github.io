<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MessageBox.Show Builder — PowerShell / C#</title>
  <style>
    :root{
      --bg:#0f1720; /* dark background for page */
      --panel:#0b1220;
      --card:#0f1725;
      --accent:linear-gradient(90deg,#5b8cff,#7dd3fc);
      --glass: rgba(255,255,255,0.03);
      --win-shadow: 0 10px 30px rgba(2,6,23,0.6);
      --radius:14px;
      --font: "Segoe UI Variable","Segoe UI","Helvetica Neue",Segoe,Arial,system-ui;
    }
    html,body{height:100%;margin:0;background:linear-gradient(180deg,#0b1220,#071023);font-family:var(--font);color:#e6eef8}
    .app{display:grid;grid-template-columns:360px 1fr 420px;gap:20px;padding:22px;height:100vh;box-sizing:border-box}/* Left panel form */
.panel{background:var(--glass);backdrop-filter: blur(6px);border-radius:12px;padding:16px;box-shadow:var(--win-shadow);display:flex;flex-direction:column;gap:12px}
.panel h2{margin:0;font-size:16px}
.field{display:flex;flex-direction:column;gap:6px}
label{font-size:12px;color:#cfe6ff}
input[type=text],select,textarea{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:8px;border-radius:8px;color:inherit;font-size:13px}
textarea{min-height:80px;resize:vertical}
.row{display:flex;gap:10px}
.checkbox-row{display:flex;flex-wrap:wrap;gap:8px}
.checkbox-row label{display:flex;align-items:center;gap:8px;font-size:13px}
.small{font-size:12px;color:#9fbbe8}

/* Center preview */
.preview-wrap{display:flex;align-items:center;justify-content:center}
.preview{width:460px;background:#f7f9fb;border-radius:12px;padding:18px;box-shadow: 0 8px 22px rgba(15,23,42,0.45);color:#06121a}
/* Simulated Windows 11 message box */
.window{width:420px;border-radius:10px;background:linear-gradient(180deg,#fff,#f5f7fb);box-shadow: 0 8px 30px rgba(2,6,23,0.5);overflow:hidden;border:1px solid rgba(2,6,23,0.06)}
.titlebar{height:34px;background:linear-gradient(180deg,#f5f8fc,#eef4fb);display:flex;align-items:center;padding:0 12px;border-bottom:1px solid rgba(2,6,23,0.04);gap:8px}
.titlebar .title{font-weight:600;color:#0b1720;font-size:13px}
.content{display:flex;gap:14px;padding:18px}
.icon{width:56px;height:56px;border-radius:8px;display:flex;align-items:center;justify-content:center}
.msg{flex:1}
.msg .text{font-size:14px;margin-bottom:8px}
.msg .caption{font-size:12px;color:#405b72}
.buttons{display:flex;gap:8px;justify-content:flex-end;padding:12px 18px;border-top:1px solid rgba(2,6,23,0.03);background:linear-gradient(180deg, rgba(0,0,0,0.01), rgba(0,0,0,0.00))}
.btn{min-width:70px;padding:8px 12px;border-radius:8px;border:1px solid rgba(2,6,23,0.06);background:transparent;font-weight:600;cursor:pointer}
.btn.primary{background:linear-gradient(90deg,#5b8cff,#7dd3fc);color:#04233a;border:none}
.btn.default{box-shadow:0 0 0 2px rgba(91,140,255,0.12) inset}

/* Right code panel */
.code-panel{background:var(--glass);padding:12px;border-radius:12px;display:flex;flex-direction:column;gap:10px}
.code-header{display:flex;align-items:center;justify-content:space-between}
.toggle{display:flex;gap:8px}
.lang-btn{padding:6px 10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;cursor:pointer}
.lang-btn.active{background:rgba(255,255,255,0.04)}
pre{background:linear-gradient(180deg,#011627,#022033);padding:12px;border-radius:8px;color:#c7f0ff;overflow-wrap:break-word;white-space:pre-wrap;font-size:13px}
.copy{padding:6px 10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);cursor:pointer}

/* small responsive tweak */
@media (max-width:1100px){.app{grid-template-columns:1fr;grid-auto-rows:auto}}

  </style>
</head>
<body>
  <div class="app">
    <div class="panel">
      <h2>MessageBox.Show Builder — Inputs</h2>
      <div class="field"><label>Text</label><textarea id="txtText">Hello from MessageBox.Show!</textarea></div>
      <div class="field"><label>Caption</label><input id="txtCaption" type="text" value="Information" /></div><div class="row">
    <div style="flex:1" class="field"><label>Buttons (MessageBoxButtons)</label>
      <select id="selButtons">
        <option value="OK">OK</option>
        <option value="OKCancel">OKCancel</option>
        <option value="YesNo">YesNo</option>
        <option value="YesNoCancel">YesNoCancel</option>
        <option value="RetryCancel">RetryCancel</option>
        <option value="AbortRetryIgnore">AbortRetryIgnore</option>
      </select>
    </div>
    <div style="width:160px" class="field"><label>Icon (MessageBoxIcon)</label>
      <select id="selIcon">
        <option value="None">None</option>
        <option value="Information">Information</option>
        <option value="Warning">Warning</option>
        <option value="Error">Error</option>
        <option value="Question">Question</option>
      </select>
    </div>
  </div>

  <div class="row">
    <div style="flex:1" class="field"><label>Default button (MessageBoxDefaultButton)</label>
      <select id="selDefaultBtn">
        <option value="Button1">Button1</option>
        <option value="Button2">Button2</option>
        <option value="Button3">Button3</option>
      </select>
    </div>
    <div style="width:160px" class="field"><label>Options</label>
      <div class="checkbox-row">
        <label><input type="checkbox" data-opt="RightAlign"/> RightAlign</label>
        <label><input type="checkbox" data-opt="RtlReading"/> RtlReading</label>
        <label><input type="checkbox" data-opt="DefaultDesktopOnly"/> DefaultDesktopOnly</label>
        <label><input type="checkbox" data-opt="ServiceNotification"/> ServiceNotification</label>
      </div>
    </div>
  </div>

  <div class="row">
    <div style="flex:1" class="field"><label>Show Help Button (showHelp)</label>
      <div class="checkbox-row"><label><input type="checkbox" id="chkHelp"/> Show Help</label></div>
    </div>
    <div style="width:160px" class="field"><label>Top-most (not standard, simulated)</label>
      <div class="checkbox-row"><label><input type="checkbox" id="chkTopMost"/> TopMost</label></div>
    </div>
  </div>

  <div class="field"><label>Owner (optional - leave blank to omit)</label><input id="txtOwner" type="text" placeholder="e.g. this" /></div>

  <div class="small">All possible MessageBox.Show parameters are exposed above (text, caption, buttons, icon, defaultButton, options, showHelp and owner). Changes update the preview and generated single-line command instantly.</div>
</div>

<div class="preview-wrap">
  <div class="preview">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px">
      <div style="font-size:12px;color:#4b6b8a">Windows 11 MessageBox Preview</div>
      <div style="font-size:12px;color:#9fbbe8">Rendered</div>
    </div>

    <div class="window" id="msgWindow" role="dialog" aria-label="MessageBox">
      <div class="titlebar"><div class="title" id="titleText">Title</div></div>
      <div class="content">
        <div id="iconWrap" class="icon" aria-hidden="true"></div>
        <div class="msg">
          <div class="text" id="previewText"></div>
          <div class="caption" id="previewCaption"></div>
        </div>
      </div>
      <div class="buttons" id="previewButtons"></div>
    </div>

  </div>
</div>

<div class="code-panel">
  <div class="code-header">
    <div style="display:flex;flex-direction:column">
      <div style="font-weight:600">Generated single-line command</div>
      <div class="small">Toggle language to emit either PowerShell or C# one-liner.</div>
    </div>
    <div class="toggle">
      <button class="lang-btn active" id="btnPS">PowerShell</button>
      <button class="lang-btn" id="btnCS">C#</button>
      <button class="copy" id="btnCopy">Copy</button>
    </div>
  </div>
  <pre id="codeBlock">/* code will appear here */</pre>
</div>

  </div>  <script>
    // Element refs
    const txtText = document.getElementById('txtText');
    const txtCaption = document.getElementById('txtCaption');
    const selButtons = document.getElementById('selButtons');
    const selIcon = document.getElementById('selIcon');
    const selDefaultBtn = document.getElementById('selDefaultBtn');
    const chkHelp = document.getElementById('chkHelp');
    const chkTopMost = document.getElementById('chkTopMost');
    const txtOwner = document.getElementById('txtOwner');
    const codeBlock = document.getElementById('codeBlock');
    const btnPS = document.getElementById('btnPS');
    const btnCS = document.getElementById('btnCS');
    const btnCopy = document.getElementById('btnCopy');

    const optCheckboxes = Array.from(document.querySelectorAll('[data-opt]'));

    // Preview refs
    const previewText = document.getElementById('previewText');
    const previewCaption = document.getElementById('previewCaption');
    const titleText = document.getElementById('titleText');
    const iconWrap = document.getElementById('iconWrap');
    const previewButtons = document.getElementById('previewButtons');
    const msgWindow = document.getElementById('msgWindow');

    let language = 'ps';

    // helper: map buttons to arrays
    const buttonsMap = {
      OK: ['OK'],
      OKCancel: ['OK','Cancel'],
      YesNo: ['Yes','No'],
      YesNoCancel: ['Yes','No','Cancel'],
      RetryCancel: ['Retry','Cancel'],
      AbortRetryIgnore: ['Abort','Retry','Ignore']
    };

    // icon svgs
    const icons = {
      None: '',
      Information: `<svg width="36" height="36" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="10" fill="#E6F0FF"/><path d="M12 8.5a1 1 0 100-2 1 1 0 000 2zM11 11h2v6h-2v-6z" fill="#0B4F9A"/></svg>`,
      Warning: `<svg width="36" height="36" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2l9 18H3L12 2z" fill="#FFF7E6"/><path d="M12 8v6" stroke="#7B5200" stroke-width="1.4" stroke-linecap="round"/><circle cx="12" cy="18" r="0.8" fill="#7B5200"/></svg>`,
      Error: `<svg width="36" height="36" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="10" fill="#FFECEC"/><path d="M15 9L9 15M9 9l6 6" stroke="#8B1515" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>`,
      Question: `<svg width="36" height="36" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="10" fill="#EFF8FF"/><path d="M11 10c0-1 1-2 2-2s2 .8 2 2c0 1-1 1.4-1.6 1.9C12.7 13 12 13.8 12 15" stroke="#0B4F9A" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"/><circle cx="12" cy="18" r="0.5" fill="#0B4F9A"/></svg>`
    };

    function escapeForCSharp(s){
      return '"'+s.replace(/\\/g,'\\\\').replace(/"/g,'\\"')+'"';
    }
    function escapeForPS(s){
      // in Powershell single quotes are easier unless they contain single quotes
      if(!s.includes("'")) return "'"+s+"'";
      // otherwise use double quotes with escaping
      return '"'+s.replace(/\\/g,'\\\\').replace(/"/g,'\\"')+'"';
    }

    function renderPreview(){
      const text = txtText.value;
      const caption = txtCaption.value;
      const buttons = selButtons.value;
      const icon = selIcon.value;
      const defaultBtn = selDefaultBtn.value;
      const opts = optCheckboxes.filter(c=>c.checked).map(c=>c.dataset.opt);
      const showHelp = chkHelp.checked;
      const topMost = chkTopMost.checked;

      // update title/caption/text
      titleText.textContent = caption || 'Message';
      previewText.textContent = text;
      previewCaption.textContent = showHelp ? 'Help button shown' : '';

      // icon
      iconWrap.innerHTML = icons[icon] || '';
      iconWrap.style.display = icon==='None'? 'none' : 'flex';

      // buttons
      previewButtons.innerHTML = '';
      const btns = buttonsMap[buttons] || ['OK'];
      btns.forEach((label, idx)=>{
        const b = document.createElement('button');
        b.className = 'btn';
        b.textContent = label;
        // default button highlight
        const defIndex = (defaultBtn==='Button1'?0:(defaultBtn==='Button2'?1:2));
        if(idx===defIndex) b.classList.add('primary');
        if(label==='OK' || label==='Yes' || label==='Retry' || label==='Abort'){
          // make typical affirmative as primary
          // prefer primary to be first normally
        }
        previewButtons.appendChild(b);
      });

      if(topMost){
        msgWindow.style.boxShadow = '0 16px 40px rgba(2,6,23,0.7), 0 0 0 4px rgba(91,140,255,0.08)';
      } else msgWindow.style.boxShadow = '';

      generateCode();
    }

    function generateCode(){
      const text = txtText.value;
      const caption = txtCaption.value;
      const buttons = selButtons.value;
      const icon = selIcon.value;
      const defaultBtn = selDefaultBtn.value;
      const opts = optCheckboxes.filter(c=>c.checked).map(c=>c.dataset.opt);
      const showHelp = chkHelp.checked;
      const owner = txtOwner.value.trim();

      // build argument list and enums
      // C#
      const csParts = [];
      if(owner) csParts.push(owner);
      csParts.push(escapeForCSharp(text));
      if(caption || buttons || icon || defaultBtn || opts.length || showHelp) csParts.push(escapeForCSharp(caption));
      if(buttons) csParts.push('System.Windows.Forms.MessageBoxButtons.'+buttons);
      if(icon && icon!=='None') csParts.push('System.Windows.Forms.MessageBoxIcon.'+icon);
      if(defaultBtn) csParts.push('System.Windows.Forms.MessageBoxDefaultButton.'+defaultBtn);
      if(showHelp) csParts.push('System.Windows.Forms.MessageBoxOptions.None /* showHelp handled by additional param in some overloads */');
      if(opts.length){
        const csOpts = opts.map(o=>'System.Windows.Forms.MessageBoxOptions.'+o).join(' | ');
        csParts.push(csOpts);
      }
      const csOneLiner = 'System.Windows.Forms.MessageBox.Show(' + csParts.join(', ') + ');';

      // PowerShell
      const psParts = [];
      if(owner) psParts.push(owner);
      psParts.push(escapeForPS(text));
      if(caption || buttons || icon || defaultBtn || opts.length || showHelp) psParts.push(escapeForPS(caption));
      if(buttons) psParts.push('[System.Windows.Forms.MessageBoxButtons]::'+buttons);
      if(icon && icon!=='None') psParts.push('[System.Windows.Forms.MessageBoxIcon]::'+icon);
      if(defaultBtn) psParts.push('[System.Windows.Forms.MessageBoxDefaultButton]::'+defaultBtn);
      if(opts.length){
        const psOpts = opts.map(o=>'[System.Windows.Forms.MessageBoxOptions]::'+o).join(' -bor ');
        psParts.push(psOpts);
      }
      if(showHelp) psParts.push('$true /* showHelp: simulated; use overloads in code */');
      const psOneLiner = '[System.Windows.Forms.MessageBox]::Show(' + psParts.join(', ') + ')';

      const final = language==='ps' ? psOneLiner : csOneLiner;
      codeBlock.textContent = final;
    }

    // wire events
    [txtText, txtCaption, selButtons, selIcon, selDefaultBtn, chkHelp, chkTopMost, txtOwner].forEach(el=>el.addEventListener('input', renderPreview));
    optCheckboxes.forEach(c=>c.addEventListener('change', renderPreview));

    btnPS.addEventListener('click', ()=>{language='ps';btnPS.classList.add('active');btnCS.classList.remove('active');generateCode();});
    btnCS.addEventListener('click', ()=>{language='cs';btnCS.classList.add('active');btnPS.classList.remove('active');generateCode();});

    btnCopy.addEventListener('click', ()=>{
      navigator.clipboard.writeText(codeBlock.textContent).then(()=>{
        btnCopy.textContent = 'Copied!';setTimeout(()=>btnCopy.textContent='Copy',1200);
      });
    });

    // initial render
    renderPreview();
  </script></body>
</html>